[platformio]
# ionOS v1.0 - Build configuration for ESP32-WROOM
default_envs = esp32
src_dir = src

[env]
# Global settings for all environments
framework = arduino
build_flags = 
    -DCORE_DEBUG_LEVEL=2
    -Wall
    -Wextra

[env:esp32]
# Main ESP32-WROOM build
platform = espressif32 @ ^6.5.0
board = esp32doit-devkit-v1
monitor_speed = 115200
upload_speed = 460800
board_build.partitions = default.csv

# Dependencies
lib_deps =
    U8g2 @ ^2.34.0
    Wire
    SPI
    SD
    FS

# Optimization flags
build_flags = 
    -DCORE_DEBUG_LEVEL=2
    -O2
    -DMBEDTLS_SHA256_SMALLER
    -ffunction-sections
    -fdata-sections
    -Wl,--gc-sections

# Serial monitor settings
monitor_speed = 115200
monitor_filters = 
    colorize
    time
    esp32_exception_decoder

# Upload settings
upload_speed = 460800
upload_port = COM3  # Change to your port (COM3 on Windows, /dev/ttyUSB0 on Linux, /dev/cu.* on macOS)

[env:esp32-debug]
# Debug build with verbose logging
extends = env:esp32
build_flags = 
    -DCORE_DEBUG_LEVEL=5
    -O0
    -g
    -DIONOS_DEBUG=1
    -Wall
    -Wextra

[env:esp32-release]
# Optimized release build
extends = env:esp32
build_flags = 
    -DCORE_DEBUG_LEVEL=1
    -O3
    -DMBEDTLS_SHA256_SMALLER
    -ffunction-sections
    -fdata-sections
    -Wl,--gc-sections

[env:esp32-ota]
# OTA-enabled build
extends = env:esp32
build_flags = 
    -DCORE_DEBUG_LEVEL=2
    -O2
    -DENABLE_OTA=1
lib_deps = 
    ${env:esp32.lib_deps}
    ArduinoOTA @ ^1.0.0
